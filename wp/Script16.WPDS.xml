<?xml version="1.0" encoding="UTF-8"?><script><script_id>16:WPDS</script_id><name>ItemCheckTrans</name><script_type_id>5</script_type_id><row_version>222</row_version><lu_id>SNEHAI</lu_id><lu_date>2015-10-27T00:56:58</lu_date><false_msg/><description>Get item where member id = 101</description><emit_events>0</emit_events><script_line><script_line_id>104:TEST</script_line_id><script_id>16:WPDS</script_id><sequence>1</sequence><script_class_id>7</script_class_id><source_name>LOCAL</source_name><row_version>1</row_version><lu_id>SNEHAI</lu_id><lu_date>2015-10-27T00:56:58</lu_date><statement>importPackage(Packages.com.csgsystems.aruba.connection);[lf]importPackage(Packages.com.csgsystems.aruba.filter);[lf]importPackage(Packages.com.csgsystems.bp.data);[lf]importPackage(Packages.com.csgsystems.aruba.filter);[lf]importPackage(Packages.com.csgsystems.fx.security);[lf]importPackage(Packages.com.csgsystems.om.session);[lf]importPackage(Packages.com.csgsystems.om.data);[lf]importPackage(Packages.java.lang);[lf]importPackage(Packages.java.math);[lf]importPackage(Packages.com.workpoint.client);[lf]importPackage(Packages.com.workpoint.common.util);[lf]importPackage(Packages.com.workpoint.common.logging);[lf][lf]logger = WPLogger.getLogger("com.workpoint.comverse.ItemCheckTrans");[lf][lf]logger.info("INFO: Transition: " + [lf]   SymbolTable.getSymbol("TranInstIDStr").getPrimaryValue() );[lf][lf]try[lf]{[lf]   jobnodeid = ThisJobTransitionData.getDestinationJobNodeID();[lf]   activityInst = ThisJobData.getActivityByNodeID(jobnodeid);[lf]   actid = activityInst.getActivityInstID();[lf][lf]   // Check to see if this script is ran in a subjob[lf]   if (ThisJobData.getJobParentID())[lf]  {[lf]     logger.debug("DEBUG: gettingparent job");[lf]     job = Job.queryByID(ClientContext, ThisJobData.getJobParentID(), true);[lf]     soid =job.getBulkUserDataString("ServiceOrderId");[lf]     oid = job.getBulkUserDataString("OrderId");[lf]     serverid = new Integer(job.getBulkUserDataString("CustomerServerId"));[lf]   }[lf]   else[lf]   {[lf]      logger.debug("DEBUG: no parent");[lf]      soid = ThisJobData.getBulkUserDataString("ServiceOrderId");[lf]      oid = ThisJobData.getBulkUserDataString("OrderId");[lf]      serverid = new Integer(ThisJobData.getBulkUserDataString("CustomerServerId"));[lf]    }[lf][lf]   // Need to check to see if job is canceled[lf]   if(ThisJobData.doesBulkUserDataExist("Canceled"))[lf]   {[lf]      logger.debug("Job is canceled");[lf]     SymbolTable.add("Result1").setValue( 0, 'FALSE' );[lf]   }[lf]   else if (!ThisJobData.doesActivityBulkUserDataExist(actid,"MemberType") ||[lf]              !ThisJobData.doesActivityBulkUserDataExist(actid,"ItemActionId"))[lf]   {[lf]     logger.debug("MemberType or ItemActionId user data not found");[lf]     SymbolTable.add("Result1").setValue( 0, 'FALSE' );[lf]   }[lf]   else[lf]   {  [lf]     sm = SecurityManagerFactory.createSecurityManager ();[lf]     bean = new ItemBean(BSDMSettings.getDefault ());[lf]     filter = new ItemObjectFilter();[lf][lf]    mtyidfilter = new Array(1);[lf]    mtyidfilter[0]=new IntegerEquals(new Integer(ThisJobData.getActivityBulkUserDataString(actid,"MemberType")));[lf]    filter.setMemberTypeFilter(mtyidfilter);[lf][lf]    if ( ThisJobData.doesActivityBulkUserDataExist(actid,"MemberId"))[lf]   {[lf]      midfilter=new Array(1);[lf]      midfilter[0]=new IntegerEquals (new Integer(ThisJobData.getActivityBulkUserDataString(actid,"MemberId")));[lf]      filter.setMemberIdFilter(midfilter);[lf]   }[lf][lf]    itemactfilter=new Array(1);[lf]    itemactfilter[0]=new IntegerEquals(new Integer(ThisJobData.getActivityBulkUserDataString(actid,"ItemActionId")));[lf]    filter.setItemActionIdFilter(itemactfilter);[lf][lf]    soarryfilter= new Array(1);[lf]    soarryfilter[0]=new BigIntegerEquals(new BigInteger(soid));[lf]    filter.setServiceOrderIdFilter(soarryfilter);[lf][lf]    context = BSDMSessionContext.getDefaultContext();[lf]    context.setSecurityContext (sm);[lf]    context.setServerId(serverid);[lf][lf]    logger.debug("Calling ItemBean Find method");[lf]    found = bean.find(context, filter);[lf][lf]    if (found.getLength() == 0)[lf]      SymbolTable.add("Result1").setValue( 0, 'FALSE' );[lf]    else[lf]      SymbolTable.add("Result1").setValue( 0, 'TRUE' );[lf]  }[lf]}[lf]catch(e)[lf]{[lf]  java.lang.System.out.println("exception: " + e);[lf]  //e.javaException.printStackTrace();[lf]  // need to put job in error[lf]  Job.recordError(ClientContext, [lf]                             new TableID(SymbolTable.getSymbol("ProcInstIDStr").getPrimaryValue()),[lf]                             "exception, see logs for details");[lf]}</statement><name/><validation_status>0</validation_status><validation_status_msg/></script_line><validation_status>0</validation_status></script>